{"ast":null,"code":"var _jsxFileName = \"/Users/shaobozhang/my_codes/my_next/pages/index.jsx\",\n    _dec,\n    _class,\n    _temp;\n\nvar __jsx = React.createElement;\nimport React from 'react';\nimport Link from 'next/link';\nimport * as BABYLON from 'babylonjs';\nimport \"../style/index.css\";\nimport dynamic from 'next/dynamic';\nimport '../style/page_index.css';\nimport Ske from '../layout/Ske';\nimport { inject, observer } from \"mobx-react\";\nconst RustComponent = dynamic({\n  loader: async () => {\n    // let cc = await import('../public/pkg/wasm_pack.js')\n    // let dd = await import('../public/pkg/wasm_pack_bg.wasm')\n    return () => __jsx(Ske, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 15\n      },\n      __self: this\n    }, __jsx(Juicy, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 16\n      },\n      __self: this\n    }));\n  }\n});\nlet Juicy = (_dec = inject('store'), _dec(_class = observer(_class = (_temp = class Juicy extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.draw2canvas = (file, canvEle, shadow = null) => {\n      console.log('here');\n      let pic = document.createElement('img');\n      pic.src = window.URL.createObjectURL(file);\n\n      pic.onload = () => {\n        canvEle.width = pic.width;\n        canvEle.height = pic.height;\n        canvEle.getContext('2d').drawImage(pic, 0, 0);\n\n        if (shadow != null) {\n          shadow.width = pic.width;\n          shadow.height = pic.height;\n          shadow.getContext('2d').drawImage(pic, 0, 0);\n        }\n      };\n    };\n\n    this.createScene = (eng, canvas) => {\n      let scene = new BABYLON.Scene(eng); // let camera = new BABYLON.FreeCamera('camera1', new BABYLON.Vector3(0, 10, -15), scene);\n\n      let camera = new BABYLON.ArcRotateCamera('c2', 0, 0, 6, new BABYLON.Vector3.Zero(), scene); //camera.setTarget(new BABYLON.Vector3(0,-5,0));//设定你要朝向哪个方向\n\n      camera.attachControl(canvas, true); //让你可以控制\n\n      camera.setPosition(new BABYLON.Vector3(0, 0, -10)); // Create a basic light, aiming 0, 1, 0 - meaning, to the sky\n\n      let light = new BABYLON.HemisphericLight('light1', new BABYLON.Vector3(0, 1, 0), scene);\n      let light2 = new BABYLON.PointLight('l2', new BABYLON.vec3(2, 0, 0), scene); // let box = BABYLON.MeshBuilder.CreateBox(\"box\", {\n      //   size:3,\n      // }, scene); // default box\n\n      let sphere = BABYLON.MeshBuilder.CreateSphere(\"sphere\", {}, scene); //default sphere\n\n      sphere.position = new BABYLON.Vector3(0, 0, 0); //var myPlane = BABYLON.MeshBuilder.CreatePlane(\"myPlane\", {width: 5, height: 2}, scene);\n      // Create a built-in \"sphere\" shape; its constructor takes 6 params: name, segment, diameter, scene, updatable, sideOrientation\n      // let sphere = BABYLON.Mesh.CreateSphere('sphere1', 16, 2, scene, false, BABYLON.Mesh.FRONTSIDE);\n      // Move the sphere upward 1/2 of its height\n      // sphere.position.y = 1;\n      // Create a built-in \"ground\" shape; its constructor takes 6 params : name, width, height, subdivision, scene, updatable\n      // let ground = BABYLON.Mesh.CreateGround('ground1', 6, 6, 2, scene, false);\n      // Return the created scene\n\n      return scene;\n    };\n\n    this.canvasRef = React.createRef();\n    this.canvasShadow = React.createRef();\n  }\n\n  render() {\n    return __jsx(\"div\", {\n      id: \"index_wrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }), __jsx(\"div\", {\n      id: \"canvas_wrapper\",\n      width: 1000,\n      height: 600,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, __jsx(\"canvas\", {\n      ref: this.canvasRef,\n      width: 1000,\n      height: 600,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }), __jsx(\"canvas\", {\n      ref: this.canvasShadow,\n      style: {\n        display: 'none'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    })), __jsx(\"img\", {\n      id: \"shadow\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }));\n  }\n\n  componentDidMount() {\n    console.log('canvas!', this.canvasRef);\n    console.log(this.props.www);\n    console.log(this.props.mmm);\n    window.__shadow = this.canvasShadow.current;\n    window.__canvas = this.canvasRef.current;\n    let _ = this.canvasRef.current;\n    let eng = new BABYLON.Engine(_, true, {\n      preserveDrawingBuffer: true,\n      stencil: true\n    });\n    let scene = this.createScene(eng, _);\n    eng.runRenderLoop(function () {\n      scene.render();\n    });\n  }\n\n}, _temp)) || _class) || _class);\nexport default Juicy;","map":{"version":3,"sources":["/Users/shaobozhang/my_codes/my_next/pages/index.jsx"],"names":["React","Link","BABYLON","dynamic","Ske","inject","observer","RustComponent","loader","Juicy","Component","constructor","props","draw2canvas","file","canvEle","shadow","console","log","pic","document","createElement","src","window","URL","createObjectURL","onload","width","height","getContext","drawImage","createScene","eng","canvas","scene","Scene","camera","ArcRotateCamera","Vector3","Zero","attachControl","setPosition","light","HemisphericLight","light2","PointLight","vec3","sphere","MeshBuilder","CreateSphere","position","canvasRef","createRef","canvasShadow","render","display","componentDidMount","www","mmm","__shadow","current","__canvas","_","Engine","preserveDrawingBuffer","stencil","runRenderLoop"],"mappings":"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","sourcesContent":["import React from 'react'\nimport Link from 'next/link';\nimport { Upload, message, Button } from 'antd';\nimport * as BABYLON from 'babylonjs'\nimport \"../style/index.css\"\nimport dynamic from 'next/dynamic'\nimport '../style/page_index.css'\nimport Ske from '../layout/Ske'\nimport { inject, observer } from \"mobx-react\"\nconst RustComponent = dynamic({\n  loader: async () => {\n    // let cc = await import('../public/pkg/wasm_pack.js')\n    // let dd = await import('../public/pkg/wasm_pack_bg.wasm')\n    return () => (\n      <Ske>\n        <Juicy  />\n      </Ske>\n    )\n  },\n})\n@inject('store')\n@observer\nclass Juicy extends React.Component {\n  constructor(props) {\n    super(props)\n    this.canvasRef = React.createRef();\n    this.canvasShadow = React.createRef();\n  }\n  draw2canvas=( file, canvEle, shadow=null )=>{\n    console.log('here')\n    let pic = document.createElement('img')\n    pic.src = window.URL.createObjectURL(file)\n    pic.onload=()=>{\n      canvEle.width = pic.width\n      canvEle.height= pic.height\n      canvEle.getContext('2d').drawImage(pic,0,0)   \n      if (shadow!=null){\n        shadow.width=pic.width\n        shadow.height=pic.height\n        shadow.getContext('2d').drawImage(pic,0,0)   \n      }\n    }\n  }\n  createScene=(eng,canvas)=>{\n    let scene = new BABYLON.Scene(eng);\n    // let camera = new BABYLON.FreeCamera('camera1', new BABYLON.Vector3(0, 10, -15), scene);\n    let camera =  new BABYLON.ArcRotateCamera('c2',0, 0,6,new BABYLON.Vector3.Zero(),scene);\n    //camera.setTarget(new BABYLON.Vector3(0,-5,0));//设定你要朝向哪个方向\n    camera.attachControl(canvas, true);//让你可以控制\n    camera.setPosition(new BABYLON.Vector3(0,0,-10))\n    // Create a basic light, aiming 0, 1, 0 - meaning, to the sky\n    let light = new BABYLON.HemisphericLight('light1', new BABYLON.Vector3(0, 1, 0), scene);\n    let light2  = new BABYLON.PointLight('l2',new BABYLON.vec3(2,0,0),scene);\n    // let box = BABYLON.MeshBuilder.CreateBox(\"box\", {\n    //   size:3,\n    // }, scene); // default box\n    let sphere = BABYLON.MeshBuilder.CreateSphere(\"sphere\", {}, scene); //default sphere\n    sphere.position=new BABYLON.Vector3(0,0,0)\n    //var myPlane = BABYLON.MeshBuilder.CreatePlane(\"myPlane\", {width: 5, height: 2}, scene);\n    // Create a built-in \"sphere\" shape; its constructor takes 6 params: name, segment, diameter, scene, updatable, sideOrientation\n    // let sphere = BABYLON.Mesh.CreateSphere('sphere1', 16, 2, scene, false, BABYLON.Mesh.FRONTSIDE);\n    // Move the sphere upward 1/2 of its height\n    // sphere.position.y = 1;\n    // Create a built-in \"ground\" shape; its constructor takes 6 params : name, width, height, subdivision, scene, updatable\n    // let ground = BABYLON.Mesh.CreateGround('ground1', 6, 6, 2, scene, false);\n    // Return the created scene\n    return scene;\n  }\n  render() {\n    return (\n      <div id=\"index_wrapper\">\n        <div>\n          {/*<Upload\n            fileList={[]}\n            beforeUpload={file=>{\n              console.log(file)\n              this.draw2canvas(file, this.canvasRef.current, this.canvasShadow.current)\n            }}\n          >\n            <Button>\n              Upload ur Pic\n            </Button>\n          </Upload>*/}\n        </div>\n        <div id=\"canvas_wrapper\" width={1000} height={600}>\n          <canvas ref={this.canvasRef} width={1000} height={600}/>\n          <canvas ref={this.canvasShadow} style={{display:'none'}} />\n        </div>\n        <img id='shadow'/>\n      </div>\n    )\n  }\n  componentDidMount() {\n    console.log('canvas!',this.canvasRef)\n    console.log(this.props.www)\n    console.log(this.props.mmm)\n    window.__shadow = this.canvasShadow.current\n    window.__canvas = this.canvasRef.current\n    let _ = this.canvasRef.current\n    let eng = new BABYLON.Engine(_,true,{preserveDrawingBuffer:true,stencil:true})\n    let scene = this.createScene(eng,_);\n    eng.runRenderLoop(function(){\n      scene.render();\n    })\n  }\n}\nexport default Juicy"]},"metadata":{},"sourceType":"module"}